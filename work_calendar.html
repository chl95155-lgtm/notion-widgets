<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Yellow Grid Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js"></script>
    <style>
        /* 1. ìº˜ë¦°ë” ì „ì²´ í…ìŠ¤íŠ¸ ë° ê·¸ë¦¬ë“œ ìŠ¤íƒ€ì¼ */
#calendar { 
    height: 750px; 
    background: white; 
    color: #3E2723; /* ì „ì²´ì ì¸ ê¸€ììƒ‰ì„ ì§„í•œ ê°ˆìƒ‰ìœ¼ë¡œ ê³ ì • */
}

/* 2. ì´ë²¤íŠ¸(ì¼ì •) ë¸”ë¡ ìŠ¤íƒ€ì¼ - ê¸€ììƒ‰ í•´ê²° í•µì‹¬! */
.fc-event { 
    cursor: pointer; 
    padding: 2px 5px !important; 
    border-radius: 6px !important; 
    border: 1px solid var(--main-yellow) !important; /* í…Œë‘ë¦¬ë¥¼ ì¡°ê¸ˆ ë” ì§„í•˜ê²Œ */
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

/* ì›”ê°„ ë³´ê¸°(Grid) ì¼ì • ìŠ¤íƒ€ì¼ */
.fc-daygrid-event { 
    background-color: var(--soft-yellow) !important; 
}

/* ì¼ì • ë‚´ë¶€ì˜ ì œëª©ê³¼ ì‹œê°„ ê¸€ììƒ‰ */
.fc-event-title, .fc-event-time { 
    color: #3E2723 !important; /* ì•„ì£¼ ì§„í•œ ê°ˆìƒ‰ìœ¼ë¡œ ê°€ë…ì„± í™•ë³´ */
    font-weight: 600 !important;
    font-size: 12px !important;
}

/* 3. ì˜¤ëŠ˜ ë‚ ì§œ ë° í—¤ë” ê°•ì¡° */
.fc-day-today { 
    background: #FFF9C4 !important; /* ì˜¤ëŠ˜ ë‚ ì§œ ì¹¸ì„ ë” ë°ì€ ë…¸ë€ìƒ‰ìœ¼ë¡œ */
}

.fc-col-header-cell {
    background-color: var(--bg-yellow);
    padding: 10px 0 !important;
    color: #5D4037;
}

/* 4. ë§ˆìš°ìŠ¤ ì˜¬ë ¸ì„ ë•Œ(Hover) íš¨ê³¼ */
.fc-event:hover {
    filter: brightness(0.95);
    transform: translateY(-1px);
    transition: all 0.2s;
}
</head>
<body>
<div class="container">
    <div class="header">
        <h2 style="margin:0; font-size:18px; color:#5D4037;">ğŸ’› 2026 ì—…ë¬´ ëŒ€ì‹œë³´ë“œ</h2>
        <button id="auth_button" class="btn-auth" onclick="handleAuthClick()">ë¡œê·¸ì¸</button>
    </div>
    <div id="calendar"></div>
</div>

<script>
    const CLIENT_ID = '582944285891-2benf275reb6i2o64d0bk5eh67okjlov.apps.googleusercontent.com';
    const API_KEY = 'AIzaSyDx-J1xtz2c1X7F7CZg1VKVbmlScDkBg8s';
    const CALENDAR_IDS = [
        'primary', 'chl95155@gmail.com', 
        'ko.south_korea#holiday@group.v.calendar.google.com'
    ];

    let calendar;
    let tokenClient;
    let gapiInited = false;

    // 1. FullCalendar ì´ˆê¸° ì„¤ì •
    document.addEventListener('DOMContentLoaded', function() {
        const calendarEl = document.getElementById('calendar');
        calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',
            locale: 'ko',
            headerToolbar: { left: 'prev,next today', center: 'title', right: 'dayGridMonth,timeGridWeek' },
            dayMaxEvents: true, // ì¼ì •ì´ ë§ìœ¼ë©´ 'ë” ë³´ê¸°'ë¡œ í‘œì‹œ
            eventTimeFormat: { hour: '2-digit', minute: '2-digit', meridiem: false, hour12: false }
        });
        calendar.render();
    });

    // 2. êµ¬ê¸€ API ì—”ì§„ ë¡œë“œ
    function gapiLoaded() { gapi.load('client', async () => {
        await gapi.client.init({ apiKey: API_KEY, discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"] });
        gapiInited = true;
    });}

    // 3. ë¡œê·¸ì¸ ëª¨ë“ˆ ì´ˆê¸°í™”
    function gisLoaded() {
        tokenClient = google.accounts.oauth2.initTokenClient({
            client_id: CLIENT_ID, scope: 'https://www.googleapis.com/auth/calendar.readonly', callback: ''
        });
    }

    function handleAuthClick() {
        tokenClient.callback = async (resp) => {
            if (resp.error) return;
            document.getElementById('auth_button').innerText = 'ë™ê¸°í™” ì¤‘...';
            await loadAllEvents();
            document.getElementById('auth_button').innerText = 'ë™ê¸°í™” ì™„ë£Œ';
        };
        tokenClient.requestAccessToken({prompt: 'consent'});
    }

    // 4. ëª¨ë“  ìº˜ë¦°ë”ì—ì„œ ì¼ì • ë¶ˆëŸ¬ì˜¤ê¸°
    async function loadAllEvents() {
        calendar.removeAllEvents(); // ê¸°ì¡´ ì¼ì • ì²­ì†Œ

        for (const id of CALENDAR_IDS) {
            try {
                const response = await gapi.client.calendar.events.list({
                    'calendarId': id,
                    'timeMin': (new Date()).toISOString(),
                    'showDeleted': false,
                    'singleEvents': true,
                    'orderBy': 'startTime'
                });

                const events = response.result.items.map(item => ({
                    title: item.summary,
                    start: item.start.dateTime || item.start.date,
                    end: item.end.dateTime || item.end.date,
                    allDay: !item.start.dateTime, // ì‹œê°„ì´ ì—†ìœ¼ë©´ ì¢…ì¼ ì¼ì •ìœ¼ë¡œ ì²˜ë¦¬
                    color: id.includes('holiday') ? '#FFCDD2' : '' // ê³µíœ´ì¼ì€ ì‚´ì§ ë‹¤ë¥¸ ìƒ‰ìœ¼ë¡œ
                }));

                calendar.addEventSource(events);
            } catch (err) {
                console.warn(id + " ë¡œë“œ ì‹¤íŒ¨:", err);
            }
        }
    }
</script>
<script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
<script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
</body>
</html>

