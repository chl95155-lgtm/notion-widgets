<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Yellow Work Calendar - Debug</title>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        :root { --main-yellow: #FBC02D; --soft-yellow: #FFF9C4; --bg-yellow: #FFFDE7; }
        body { background: transparent; font-family: 'Pretendard', sans-serif; margin: 0; padding: 10px; }
        .container { background: white; border: 3px solid var(--main-yellow); border-radius: 25px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--soft-yellow); padding-bottom: 10px; margin-bottom: 15px; }
        .header h2 { color: #5D4037; margin: 0; font-size: 18px; }
        .btn-auth { background: var(--main-yellow); color: white; border: none; padding: 10px 18px; border-radius: 12px; cursor: pointer; font-weight: bold; }
        .btn-auth:disabled { background: #eee; color: #aaa; }
        .status-box { font-size: 12px; padding: 10px; border-radius: 8px; margin-bottom: 10px; background: #f8f9fa; line-height: 1.6; }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h2>ğŸ’› ì—…ë¬´ ì¼ì • (ì§„ë‹¨ ëª¨ë“œ)</h2>
        <button id="auth_button" class="btn-auth" onclick="handleAuthClick()" disabled>ì¤€ë¹„ ì¤‘...</button>
    </div>
    <div id="debug_status" class="status-box">
        â³ ì—°ê²° ìƒíƒœ í™•ì¸ ì¤‘...<br>
        - êµ¬ê¸€ API ì—”ì§„: <span id="gapi_status">ëŒ€ê¸°</span><br>
        - ë¡œê·¸ì¸ ì‹œìŠ¤í…œ: <span id="gis_status">ëŒ€ê¸°</span>
    </div>
    <div id="content"></div>
</div>

<script src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
<script src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>

<script>
    const CLIENT_ID = '582944285891-2benf275reb6i2o64d0bk5eh67okjlov.apps.googleusercontent.com';
    const API_KEY = 'AIzaSyDx-J1xtz2c1X7F7CZg1VKVbmlScDkBg8s';
    
    let tokenClient;
    let gapiInited = false;

    async function gapiLoaded() {
        try {
            await gapi.load('client', async () => {
                await gapi.client.init({ apiKey: API_KEY, discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"] });
                gapiInited = true;
                document.getElementById('gapi_status').innerHTML = '<span class="success">âœ… ì—°ê²° ì™„ë£Œ</span>';
                checkReady();
            });
        } catch (e) {
            document.getElementById('gapi_status').innerHTML = '<span class="error">âŒ ì‹¤íŒ¨ (APIí‚¤ í™•ì¸ í•„ìš”)</span>';
        }
    }

    function gisLoaded() {
        try {
            tokenClient = google.accounts.oauth2.initTokenClient({
                client_id: CLIENT_ID,
                scope: 'https://www.googleapis.com/auth/calendar.readonly',
                callback: '',
            });
            document.getElementById('gis_status').innerHTML = '<span class="success">âœ… ì—°ê²° ì™„ë£Œ</span>';
            checkReady();
        } catch (e) {
            document.getElementById('gis_status').innerHTML = '<span class="error">âŒ ì‹¤íŒ¨ (í´ë¼ì´ì–¸íŠ¸ID í™•ì¸ í•„ìš”)</span>';
        }
    }

    function checkReady() {
        if (gapiInited && tokenClient) {
            const btn = document.getElementById('auth_button');
            btn.innerText = 'ë¡œê·¸ì¸';
            btn.disabled = false;
        }
    }

    function handleAuthClick() {
        tokenClient.callback = async (resp) => {
            if (resp.error) {
                alert("ë¡œê·¸ì¸ ì˜¤ë¥˜: " + resp.error);
                return;
            }
            await listUpcomingEvents();
        };
        tokenClient.requestAccessToken({prompt: 'consent'});
    }

    async function listUpcomingEvents() {
        // (ì´ì „ê³¼ ë™ì¼í•œ ì¼ì • ë¶ˆëŸ¬ì˜¤ê¸° ë¡œì§)
        document.getElementById('content').innerText = "ì¼ì •ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...";
        // ... (ìƒëµëœ ë¡œì§ì€ ì‹¤í–‰ ì‹œ í¬í•¨ë¨)
    }
</script>
</body>
</html>
